#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__)
require 'css_pal'

def pattern
  value_pattern = /(\d*[\.,]?\d*,?\d*)/
  mode_pattern = /(.*)/
  /#{value_pattern}#{mode_pattern}/
end

begin
  mode, param = ARGV

  raise "Correct format css_pal <mode> <value>" if mode.nil? || param.nil?

  value, unit = param.match(pattern)[1..2]

  action = "#{unit}_#{mode}".gsub(/^_/,'')

  puts UnitConverter.send(action, value)
rescue NoMethodError => e
  puts "I don't know how to '#{action}'"
  exit 1
rescue Exception => e
  puts e.message
  exit 1
end
